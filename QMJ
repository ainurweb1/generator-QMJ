import React, { useState } from 'react';
import { RefreshCw, Download, Sparkles, BookOpen, CheckCircle, Target, Monitor } from 'lucide-react';

const LandscapeLessonPlan = () => {
  const [formData, setFormData] = useState({
    school: '',
    section: '',
    teacherName: '',
    date: new Date().toISOString().slice(0, 10),
    grade: '',
    attendees: '',
    absentees: '',
    theme: '',
    learningObjectives: '',
    lessonObjectives: '',
    optionalText: '', 
  });

  const [lessonSteps, setLessonSteps] = useState([]);
  const [generatedObjectives, setGeneratedObjectives] = useState('');
  const [loading, setLoading] = useState(false);
  const [isGenerated, setIsGenerated] = useState(false);

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const generateWithAI = async () => {
    if (!formData.theme || !formData.learningObjectives) {
      alert("–°–∞–±–∞“õ—Ç—ã“£ —Ç–∞“õ—ã—Ä—ã–±—ã –º–µ–Ω –û“õ—É –º–∞“õ—Å–∞—Ç—Ç–∞—Ä—ã–Ω –º—ñ–Ω–¥–µ—Ç—Ç—ñ —Ç“Ø—Ä–¥–µ –∂–∞–∑—ã“£—ã–∑!");
      return;
    }
    setLoading(true);

    const apiKey = ""; 
    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

    const prompt = `
      –°—ñ–∑ –∂–æ“ì–∞—Ä—ã —Å–∞–Ω–∞—Ç—Ç—ã –ø–µ–¥–∞–≥–æ–≥-”ô–¥—ñ—Å–∫–µ—Ä—Å—ñ–∑. “ö–∞–∑–∞“õ—Å—Ç–∞–Ω–¥—ã“õ –∂–∞“£–∞—Ä—Ç—ã–ª“ì–∞–Ω –±—ñ–ª—ñ–º –±–µ—Ä—É –±–∞“ì–¥–∞—Ä–ª–∞–º–∞—Å—ã –±–æ–π—ã–Ω—à–∞ “ö–ú–ñ (“ö—ã—Å“õ–∞ –º–µ—Ä–∑—ñ–º–¥—ñ –∂–æ—Å–ø–∞—Ä) –∂–∞—Å–∞“£—ã–∑.

      –î–µ—Ä–µ–∫—Ç–µ—Ä:
      - –¢–∞“õ—ã—Ä—ã–ø: ${formData.theme}
      - –û“õ—É –º–∞“õ—Å–∞—Ç—ã (–û–ú): ${formData.learningObjectives}
      - “ö–æ—Å—ã–º—à–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç: ${formData.optionalText}

      –¢–ê–ü–°–´–†–ú–ê–õ–ê–† (–û—Ä—ã–Ω–¥–∞—É —à–∞—Ä—Ç—Ç–∞—Ä—ã):
      
      1. **–°–∞–±–∞“õ –º–∞“õ—Å–∞—Ç—ã:** –û–ú –Ω–µ–≥—ñ–∑—ñ–Ω–¥–µ SMART –º–∞“õ—Å–∞—Ç “õ“±—Ä–∞—Å—Ç—ã—Ä.

      2. **–ú”ô—Ç—ñ–Ω —Ç–∞–∑–∞–ª—ã“ì—ã:** –ñ“±–ª–¥—ã–∑—à–∞ (*), —Ä–µ—à–µ—Ç–∫–∞ (#) —Å–∏—è“õ—Ç—ã Markdown –±–µ–ª–≥—ñ–ª–µ—Ä—ñ–Ω –º“Ø–ª–¥–µ “õ–æ–ª–¥–∞–Ω–±–∞. –°”©–π–ª–µ–º–¥–µ—Ä —à—ã–Ω–∞–π—ã, ”ô–¥–µ–±–∏ —Ç—ñ–ª–º–µ–Ω –∂–∞–∑—ã–ª—Å—ã–Ω.

      3. **“ö“±—Ä—ã–ª—ã–º—ã (3 –Ω–µ–≥—ñ–∑–≥—ñ –±–ª–æ–∫):**
         
         A) **–°–∞–±–∞“õ—Ç—ã“£ –±–∞—Å—ã (10 –º–∏–Ω):**
            - "–Ü –∫–µ–∑–µ“£. “∞–π—ã–º–¥–∞—Å—Ç—ã—Ä—É –∫–µ–∑–µ“£—ñ" (–∞–º–∞–Ω–¥–∞—Å—É, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è–ª—ã“õ –∞—Ö—É–∞–ª - –∏–∫–æ–Ω–∫–∞–ª–∞—Ä–º–µ–Ω).
            - "–Ü–Ü –∫–µ–∑–µ“£. “ö—ã–∑—ã“ì—É—à—ã–ª—ã“õ—Ç—ã –æ—è—Ç—É" (–û–π —à–∞“õ—ã—Ä—É ”ô–¥—ñ—Å—ñ, –º–∞“õ—Å–∞—Ç—Ç—ã —Ç–∞–Ω—ã—Å—Ç—ã—Ä—É).
         
         B) **–°–∞–±–∞“õ—Ç—ã“£ –æ—Ä—Ç–∞—Å—ã (30 –º–∏–Ω) - –ú–∞“ì—ã–Ω–∞–Ω—ã —Ç–∞–Ω—É:**
            - –ñ–∞“£–∞ —Ç–∞“õ—ã—Ä—ã–ø—Ç—ã —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä—É (–†–µ—Å—É—Ä—Å–ø–µ–Ω –∂“±–º—ã—Å).
            - **3 –Ω–∞“õ—Ç—ã —Ç–∞–ø—Å—ã—Ä–º–∞** (–ò–∫–æ–Ω–∫–∞–ª–∞—Ä–º–µ–Ω –±–µ–∑–µ–Ω–¥—ñ—Ä):
              1. –ñ–µ–∫–µ –∂“±–º—ã—Å (3 –±–∞–ª–ª).
              2. –ñ“±–ø—Ç—ã“õ –∂“±–º—ã—Å (3 –±–∞–ª–ª).
              3. –¢–æ–ø—Ç—ã“õ –∂“±–º—ã—Å (4 –±–∞–ª–ª).
            - –¢–∞–ø—Å—ã—Ä–º–∞–ª–∞—Ä–¥—ã“£ —à–∞—Ä—Ç—ã –º–µ–Ω –º–∞–∑–º“±–Ω—ã "–ú“±“ì–∞–ª—ñ–º ”ô—Ä–µ–∫–µ—Ç—ñ–Ω–¥–µ" ”©—Ç–µ —Ç–æ–ª—ã“õ –∂–∞–∑—ã–ª—Å—ã–Ω.
         
         C) **–°–∞–±–∞“õ—Ç—ã“£ —Å–æ“£—ã (5 –º–∏–Ω):**
            - –ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å. –†–µ—Ñ–ª–µ–∫—Å–∏—è. “Æ–π —Ç–∞–ø—Å—ã—Ä–º–∞—Å—ã.

      4. **–ï—Ä–µ–∫—à–µ —Ç–∞–ª–∞–ø—Ç–∞—Ä:**
         - **–ë–∞“ì–∞–ª–∞—É –±–∞“ì–∞–Ω—ã:** –¢–ï–ö “ö–´–°“ö–ê–®–ê –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∂–∞–∑. (–ú—ã—Å–∞–ª—ã: "–°“±—Ä–∞“õ“õ–∞ –∂–∞—É–∞–ø –±–µ—Ä–µ–¥—ñ - 1 –±–∞–ª–ª"). “∞–∑–∞“õ —Å”©–π–ª–µ–º –∂–∞–∑–±–∞.
         - **–û“õ—É—à—ã ”ô—Ä–µ–∫–µ—Ç—ñ:** –û“õ—É—à—ã–Ω—ã“£ –∂–∞—É–∞–±—ã–Ω ”©—Ç–µ —Ç–æ–ª—ã“õ –∂–∞–∑. –ï–≥–µ—Ä —Å–∞–ª—ã—Å—Ç—ã—Ä—É –Ω–µ–º–µ—Å–µ —Ç–∞–ª–¥–∞—É –±–æ–ª—Å–∞, –∂–∞—É–∞–ø—Ç—ã HTML table (<table border="1">...</table>) –∫–æ–¥—ã–º–µ–Ω –±–µ—Ä.

      –ñ–∞—É–∞–ø—Ç—ã —Ç–µ–∫ —Ç”©–º–µ–Ω–¥–µ–≥—ñ JSON —Ñ–æ—Ä–º–∞—Ç—ã–Ω–¥–∞ “õ–∞–π—Ç–∞—Ä:
      {
        "generated_objectives": "–°–∞–±–∞“õ –º–∞“õ—Å–∞—Ç—ã...",
        "steps": [
          {
            "stage": "–°–∞–±–∞“õ—Ç—ã“£ –±–∞—Å—ã...",
            "teacherAction": "...",
            "studentAction": "...",
            "assessment": "...",
            "resource": "..."
          }
        ]
      }
    `;

    try {
      const response = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
      });

      if (!response.ok) throw new Error("Server Error");

      const data = await response.json();
      let text = data.candidates?.[0]?.content?.parts?.[0]?.text;

      if (!text) throw new Error("–ñ–∞—É–∞–ø –±–æ—Å –∫–µ–ª–¥—ñ");

      const startIndex = text.indexOf('{');
      const endIndex = text.lastIndexOf('}');
      if (startIndex !== -1 && endIndex !== -1) {
        text = text.substring(startIndex, endIndex + 1);
      }
      
      text = text.replace(/\*\*/g, '').replace(/\*/g, '');
      const parsedData = JSON.parse(text);
      
      if (!parsedData.steps || !Array.isArray(parsedData.steps)) {
          throw new Error("–î“±—Ä—ã—Å –µ–º–µ—Å –¥–µ—Ä–µ–∫—Ç–µ—Ä —Ñ–æ—Ä–º–∞—Ç—ã");
      }

      setGeneratedObjectives(parsedData.generated_objectives || '');
      if(!formData.lessonObjectives) {
          setFormData(prev => ({...prev, lessonObjectives: parsedData.generated_objectives || ''}));
      }

      setLessonSteps(parsedData.steps);
      setIsGenerated(true);
    } catch (err) {
      console.error(err);
      alert("“ö–∞—Ç–µ: " + err.message);
    } finally {
      setLoading(false);
    }
  };

  // Word Export (Landscape Logic)
  const exportToWord = () => {
    if (!lessonSteps || lessonSteps.length === 0) {
        alert("–ñ–æ—Å–ø–∞—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞–Ω–±–∞“ì–∞–Ω!");
        return;
    }

    // –ê–ª—å–±–æ–º–¥—ã“õ (Landscape) —Ñ–æ—Ä–º–∞—Ç“õ–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω CSS
    const preHtml = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
    <head><meta charset='utf-8'><title>Landscape Lesson Plan</title>
    <style>
      @page {
        size: landscape;
        mso-page-orientation: landscape;
        margin: 1.5cm;
      }
      @page Section1 {
        size: 841.9pt 595.3pt; /* A4 Landscape */
        mso-page-orientation: landscape;
        margin: 1.5cm;
      }
      div.Section1 { page: Section1; }
      body { font-family: 'Times New Roman', serif; font-size: 11pt; }
      table { border-collapse: collapse; width: 100%; margin-bottom: 10px; }
      td, th { border: 1px solid black; padding: 7px; vertical-align: top; }
      .center { text-align: center; }
      .bold { font-weight: bold; }
      .bg-header { background-color: #eef2ff; }
      .task-box { border: 1px solid #000; padding: 8px; margin: 5px 0; background-color: #fff; }
      
      /* Inner table styles */
      table table { width: 100%; margin-top: 5px; border: 1px solid #666; }
      table table td { border: 1px solid #666; font-size: 10pt; }
    </style>
    </head><body><div class="Section1">`;
    
    let content = `
        <div class="center bold" style="font-size: 12pt;">${formData.school || ''}</div>
        <div class="center bold" style="font-size: 14pt; margin-top: 10px;">“ö—ã—Å“õ–∞ –º–µ—Ä–∑—ñ–º–¥—ñ (—Å–∞–±–∞“õ) –∂–æ—Å–ø–∞—Ä</div>
        <br>
        
        <table>
            <tr><td class="bold" width="20%">–ë”©–ª—ñ–º:</td><td colspan="2">${formData.section || ''}</td></tr>
            <tr><td class="bold">–ü–µ–¥–∞–≥–æ–≥—Ç—ñ“£ –∞—Ç—ã-–∂”©–Ω—ñ:</td><td colspan="2">${formData.teacherName || ''}</td></tr>
            <tr><td class="bold">–ö“Ø–Ω—ñ:</td><td colspan="2">${formData.date}</td></tr>
            <tr>
                <td class="bold">–°—ã–Ω—ã–ø: ${formData.grade || ''}</td>
                <td>“ö–∞—Ç—ã—Å—É—à—ã–ª–∞—Ä: ${formData.attendees || ''}</td>
                <td>“ö–∞—Ç—ã—Å–ø–∞“ì–∞–Ω–¥–∞—Ä: ${formData.absentees || ''}</td>
            </tr>
            <tr><td class="bold">–°–∞–±–∞“õ—Ç—ã“£ —Ç–∞“õ—ã—Ä—ã–±—ã:</td><td colspan="2">${formData.theme || ''}</td></tr>
            <tr><td class="bold">–û“õ—É –º–∞“õ—Å–∞—Ç—Ç–∞—Ä—ã:</td><td colspan="2">${formData.learningObjectives || ''}</td></tr>
            <tr><td class="bold">–°–∞–±–∞“õ—Ç—ã“£ –º–∞“õ—Å–∞—Ç—ã:</td><td colspan="2">${formData.lessonObjectives || generatedObjectives || ''}</td></tr>
            <tr><td class="bold bg-header center" colspan="3">–°–∞–±–∞“õ—Ç—ã“£ –±–∞—Ä—ã—Å—ã</td></tr>
        </table>

        <table>
            <tr class="bg-header bold center">
                <th width="10%">–ö–µ–∑–µ“£/–£–∞“õ—ã—Ç</th>
                <th width="35%">–ü–µ–¥–∞–≥–æ–≥—Ç—ñ“£ ”ô—Ä–µ–∫–µ—Ç—ñ</th>
                <th width="35%">–û“õ—É—à—ã–Ω—ã“£ ”ô—Ä–µ–∫–µ—Ç—ñ</th>
                <th width="12%">–ë–∞“ì–∞–ª–∞—É</th>
                <th width="8%">–†–µ—Å—É—Ä—Å</th>
            </tr>
    `;

    lessonSteps.forEach((step) => {
       const rawTeacherAction = step.teacherAction || '';
       const rawStudentAction = step.studentAction || '';
       const rawAssessment = step.assessment || '';
       const rawResource = step.resource || '';

       let teacherActionFormatted = rawTeacherAction
            .replace(/\n/g, '<br>')
            .replace(/–Ü –∫–µ–∑–µ“£/g, '<b>–Ü –∫–µ–∑–µ“£</b>')
            .replace(/–Ü–Ü –∫–µ–∑–µ“£/g, '<b>–Ü–Ü –∫–µ–∑–µ“£</b>')
            .replace(/(\d-—Ç–∞–ø—Å—ã—Ä–º–∞[^<]*)/g, '<div class="task-box"><b>$1</b>') 
            .replace(/(–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä)/g, '<br><i>$1</i>');

       content += `
            <tr>
                <td class="bold center">${step.stage || ''}</td>
                <td>${teacherActionFormatted}</td>
                <td style="color:#333;">
                    ${rawStudentAction.includes('<table') ? rawStudentAction : rawStudentAction.replace(/\n/g, '<br>')}
                </td>
                <td style="text-align:center;">${rawAssessment.replace(/\n/g, '<br>')}</td>
                <td style="text-align:center;">${rawResource}</td>
            </tr>
        `;
    });

    content += "</table></div></body></html>";

    const blob = new Blob(['\ufeff', preHtml + content], { type: 'application/msword' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `KMZ_Landscape_${formData.theme.replace(/\s/g, '_')}.doc`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  };

  return (
    <div className="min-h-screen bg-gray-100 p-4 font-sans text-gray-800">
      <div className="max-w-7xl mx-auto bg-white shadow-xl rounded-xl overflow-hidden border border-gray-200">
        
        <header className="bg-teal-700 p-6 text-white flex justify-between items-center">
          <div>
            <h1 className="text-2xl font-bold flex items-center gap-2">
              <Monitor className="h-8 w-8 text-teal-200" />
              “ö–ú–ñ: –ê–ª—å–±–æ–º–¥—ã“õ –§–æ—Ä–º–∞—Ç
            </h1>
            <p className="text-teal-100 text-sm mt-1">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–¥—ã –±–∞“ì–¥–∞—Ä ‚Ä¢ –ö–µ“£ –∫–µ—Å—Ç–µ–ª–µ—Ä ‚Ä¢ –¢–æ–ª—ã“õ –º–∞–∑–º“±–Ω</p>
          </div>
        </header>

        <div className="grid grid-cols-1 lg:grid-cols-3 h-full">
          
          {/* –°–æ–ª –∂–∞“õ: –ï–Ω–≥—ñ–∑—É */}
          <div className="p-6 bg-gray-50 border-r border-gray-200 space-y-4 overflow-y-auto lg:h-[800px]">
            <div className="flex items-center gap-2 text-teal-800 font-bold border-b pb-2">
                <Target size={20} /> –°–∞–±–∞“õ –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ
            </div>

            <input name="school" placeholder="–ú–µ–∫—Ç–µ–ø –∞—Ç—ã" className="input-teal" onChange={handleInputChange} />
            <input name="teacherName" placeholder="–ú“±“ì–∞–ª—ñ–º –∞—Ç—ã-–∂”©–Ω—ñ" className="input-teal" onChange={handleInputChange} />
            <div className="grid grid-cols-2 gap-2">
                <input name="section" placeholder="–ë”©–ª—ñ–º" className="input-teal" onChange={handleInputChange} />
                <input name="grade" placeholder="–°—ã–Ω—ã–ø" className="input-teal" onChange={handleInputChange} />
            </div>

            <div className="bg-white p-4 rounded-lg border border-teal-100 shadow-sm space-y-3">
                <label className="text-xs font-bold text-teal-900 uppercase">–ù–µ–≥—ñ–∑–≥—ñ –±”©–ª—ñ–º</label>
                <input name="theme" placeholder="–°–∞–±–∞“õ —Ç–∞“õ—ã—Ä—ã–±—ã (–ú—ñ–Ω–¥–µ—Ç—Ç—ñ)" className="input-teal border-teal-300 bg-teal-50" onChange={handleInputChange} />
                
                <div className="relative">
                    <textarea name="learningObjectives" placeholder="–û“õ—É –º–∞“õ—Å–∞—Ç—ã (–ö–æ–¥)" className="input-teal h-24" onChange={handleInputChange}></textarea>
                </div>

                {generatedObjectives && (
                    <div className="p-3 bg-green-50 border border-green-200 rounded text-sm">
                        <span className="font-bold text-green-800 block mb-1">üéØ –ú–∞“õ—Å–∞—Ç (AI):</span>
                        {generatedObjectives}
                    </div>
                )}
            </div>

             <div className="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                <label className="text-xs font-bold text-yellow-800 block mb-2">
                    “ö–æ—Å—ã–º—à–∞ –º–∞—Ç–µ—Ä–∏–∞–ª (–ú”ô—Ç—ñ–Ω/–∂–∞—Ç—Ç—ã“ì—É):
                </label>
                <textarea name="optionalText" placeholder="AI –æ—Å—ã –º”ô—Ç—ñ–Ω–Ω–µ–Ω –∫–µ—Å—Ç–µ–ª—ñ —Ç–∞–ø—Å—ã—Ä–º–∞ “õ“±—Ä–∞–¥—ã..." className="input-teal h-24 text-sm" onChange={handleInputChange}></textarea>
            </div>

            <button 
                onClick={generateWithAI}
                disabled={loading}
                className="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-4 rounded-lg transition-all flex items-center justify-center gap-2 shadow-md disabled:opacity-70"
            >
                {loading ? <RefreshCw className="animate-spin" /> : <Sparkles />}
                {loading ? "–ñ–æ—Å–ø–∞—Ä “õ“±—Ä—ã–ª—É–¥–∞..." : "“ö–ú–ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É"}
            </button>
          </div>

          {/* –û“£ –∂–∞“õ: –ù”ô—Ç–∏–∂–µ */}
          <div className="lg:col-span-2 p-8 bg-white flex flex-col h-full">
            <div className="flex justify-between items-center mb-6 border-b pb-4">
                <h2 className="text-xl font-bold text-gray-700">–ù”ô—Ç–∏–∂–µ “Ø–ª–≥—ñ—Å—ñ (–ê–ª—å–±–æ–º–¥—ã“õ)</h2>
                {isGenerated && (
                    <button onClick={exportToWord} className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2 shadow transition">
                        <Download size={18} /> Word –ñ“Ø–∫—Ç–µ—É
                    </button>
                )}
            </div>

            <div className="flex-grow overflow-y-auto pr-2 custom-scrollbar max-h-[700px]">
                {!isGenerated && !loading && (
                    <div className="flex flex-col items-center justify-center h-64 text-gray-400 border-2 border-dashed rounded-lg">
                        <Monitor className="h-12 w-12 mb-2 opacity-30" />
                        <p>–ú”ô–ª—ñ–º–µ—Ç—Ç–µ—Ä–¥—ñ –µ–Ω–≥—ñ–∑—ñ–ø, –±–∞—Ç—ã—Ä–º–∞–Ω—ã –±–∞—Å—ã“£—ã–∑</p>
                    </div>
                )}

                {loading && (
                     <div className="space-y-4 animate-pulse">
                        <div className="h-8 bg-gray-200 rounded w-1/3"></div>
                        <div className="h-32 bg-gray-200 rounded"></div>
                        <div className="h-32 bg-gray-200 rounded"></div>
                    </div>
                )}

                {isGenerated && (
                    <div className="border border-gray-800 font-serif text-sm w-full overflow-x-auto">
                         {/* Preveiw –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ —Å”ô–ª —Ç–∞—Ä –±–æ–ª—É—ã –º“Ø–º–∫—ñ–Ω, –±—ñ—Ä–∞“õ Word-—Ç–∞ –∫–µ“£ –±–æ–ª–∞–¥—ã */}
                         <div className="p-4 border-b border-gray-800 bg-gray-50">
                            <p><strong>–¢–∞“õ—ã—Ä—ã–ø:</strong> {formData.theme}</p>
                            <p className="mt-2"><strong>–û–ú:</strong> {formData.learningObjectives}</p>
                            <p className="mt-2"><strong>–°–∞–±–∞“õ –º–∞“õ—Å–∞—Ç—ã:</strong> {formData.lessonObjectives || generatedObjectives}</p>
                        </div>

                        <div className="grid grid-cols-12 bg-teal-100 font-bold text-center border-b border-gray-800 text-xs md:text-sm">
                            <div className="col-span-1 p-2 border-r border-gray-800">–ö–µ–∑–µ“£</div>
                            <div className="col-span-4 p-2 border-r border-gray-800">–ú“±“ì–∞–ª—ñ–º ”ô—Ä–µ–∫–µ—Ç—ñ</div>
                            <div className="col-span-4 p-2 border-r border-gray-800">–û“õ—É—à—ã ”ô—Ä–µ–∫–µ—Ç—ñ</div>
                            <div className="col-span-2 p-2 border-r border-gray-800">–ë–∞“ì–∞–ª–∞—É</div>
                            <div className="col-span-1 p-2">–†–µ—Å—É—Ä—Å</div>
                        </div>
                        
                        {lessonSteps.map((step, idx) => (
                            <div key={idx} className="grid grid-cols-12 border-b border-gray-800 last:border-0 text-xs md:text-sm hover:bg-gray-50">
                                <div className="col-span-1 p-2 border-r border-gray-800 font-bold text-center flex items-center justify-center bg-gray-50">
                                    {step.stage}
                                </div>
                                <div className="col-span-4 p-2 border-r border-gray-800 whitespace-pre-wrap leading-relaxed">
                                    {step.teacherAction}
                                </div>
                                <div className="col-span-4 p-2 border-r border-gray-800 italic text-gray-700 bg-blue-50/10">
                                     {/* HTML –º–∞–∑–º“±–Ω—ã–Ω (–∫–µ—Å—Ç–µ–ª–µ—Ä–¥—ñ) –∫”©—Ä—Å–µ—Ç—É */}
                                     <div dangerouslySetInnerHTML={{ __html: step.studentAction }} />
                                </div>
                                <div className="col-span-2 p-2 border-r border-gray-800 text-center font-semibold text-teal-800">
                                    {step.assessment}
                                </div>
                                <div className="col-span-1 p-2 flex items-center justify-center text-center text-xs">
                                    {step.resource}
                                </div>
                            </div>
                        ))}
                    </div>
                )}

                {isGenerated && (
                     <div className="mt-4 p-3 bg-teal-50 text-teal-800 rounded flex items-center gap-2 text-sm border border-teal-200">
                        <CheckCircle size={16}/>
                        <span>Word “õ“±–∂–∞—Ç—ã "Landscape" (–ê–ª—å–±–æ–º) —Ñ–æ—Ä–º–∞—Ç—ã–Ω–¥–∞ –∂“Ø–∫—Ç–µ–ª–µ–¥—ñ.</span>
                    </div>
                )}
            </div>
          </div>
        </div>
      </div>
      <style>{`
        .input-teal {
          width: 100%;
          padding: 10px;
          border: 1px solid #cbd5e1;
          border-radius: 8px;
          outline: none;
          transition: all 0.2s;
        }
        .input-teal:focus {
          border-color: #0d9488;
          box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.1);
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 10px; }
        
        /* Table styles for inner HTML content */
        table { width: 100%; border-collapse: collapse; margin-top: 5px; }
        td, th { border: 1px solid #ccc; padding: 4px; }
      `}</style>
    </div>
  );
};

export default LandscapeLessonPlan;
